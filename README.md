# 复现论文Revisiting Multiple Instance Neural Networks
## 1.文件说明
“train_mi.py”文件是mi-Net模型。

“MI_net.py”文件是MI-net模型。

“MI_net_DS.py”文件是 MI-net with deep supervision模型。

"MI_Res.py"文件是MI-net with Res 模型。

"loader.py"文件是针对MUSK1/2数据集的导入方法。

"pre_.py"文件是针对fox/elephant/tiger数据集的导入方法，导入数据集的同时对数据集的顺序进行了打乱，由于没有找到文中的第三个数据集，故第三个数据集的导入函数尚未编写。

"main.py"文件是训练、测试文件，可以通过修改注释改变导入的数据集和模型。

## 2.环境
实验均在manjaro系统下完成，利用anaconda建立虚拟环境，使用CPU版本的pytorch进行实验，python版本为3.7.11。
## 3.训练过程
对每个网络的每个数据集作十折交叉验证，即将数据集分为十份，每次取9份做训练，取1份做测试，总共做十次，使得每份数据都有做过测试集，取十次结果的平均数。总共训练五次求平均数，每次都在训练集上做多次迭代训练再在测试集上做验证.迭代次数根据训练模型在测试集上的泛化性能决定，例如实验中发现MI-net_DS网络在fox数据集上迭代300次时泛化性能最好。

训练过程采用随机梯度下降算法，学习率设置为0.01

## 4.实验结果


|   | MUSK1 | MUSK2 | fox | elepant | tiger |
|---| -----|------| -----|---------|--------|
|mi-net|81.957%|75.294%|62.200%|84.300%|81.700%|
|MI-net|87.174%|72.353%|62.400%|86.400%|81.400%
|MI-Net-DS|92.826%|80.980%|62.400%|87.200%|82.200%
|MI-Net-RS|89.783%|83.333%|

迭代次数

|    |MUSK1|MUSK2|fox|elephant|tiger|
|----|----|----|----|----|----|
|mi-net|400|200|200|400|200|
|MI-net|200|150|200|200|200|
|MI-net-DS|220|80|300|150|600
|MI-net-RS|500|300|